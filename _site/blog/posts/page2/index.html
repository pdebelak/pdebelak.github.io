<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Blog | Peter Debelak</title>
    <meta name="description" content="Posts about Ruby, Rails, and other technical topics from Peter Debelak">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
    <style>
      h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.post-title,.h4,.resume-section .section-title h1,.h5,.h6{font-family:inherit;font-weight:500;line-height:1.1;color:inherit}h1 small,h1 .small,h2 small,h2 .small,h3 small,h3 .small,h4 small,h4 .small,h5 small,h5 .small,h6 small,h6 .small,.h1 small,.h1 .small,.h2 small,.h2 .small,.h3 small,.post-title small,.h3 .small,.post-title .small,.h4 small,.resume-section .section-title h1 small,.h4 .small,.resume-section .section-title h1 .small,.h5 small,.h5 .small,.h6 small,.h6 .small{font-weight:normal;line-height:1;color:#777}h1,.h1,h2,.h2,h3,.h3,.post-title{margin-top:20px;margin-bottom:10px}h1 small,h1 .small,.h1 small,.h1 .small,h2 small,h2 .small,.h2 small,.h2 .small,h3 small,h3 .small,.h3 small,.post-title small,.h3 .small,.post-title .small{font-size:65%}h4,.h4,.resume-section .section-title h1,h5,.h5,h6,.h6{margin-top:10px;margin-bottom:10px}h4 small,h4 .small,.h4 small,.resume-section .section-title h1 small,.h4 .small,.resume-section .section-title h1 .small,h5 small,h5 .small,.h5 small,.h5 .small,h6 small,h6 .small,.h6 small,.h6 .small{font-size:75%}h1,.h1{font-size:36px}h2,.h2{font-size:30px}h3,.h3,.post-title{font-size:24px}h4,.h4,.resume-section .section-title h1{font-size:18px}h5,.h5{font-size:14px}h6,.h6{font-size:12px}p{margin:0 0 10px}small,.small{font-size:85%}.text-right{text-align:right}.pull-left{float:left !important}ul,ol{margin-top:0;margin-bottom:10px}ul ul,ul ol,ol ul,ol ol{margin-bottom:0}code{padding:2px 4px;font-size:90%;color:#333;background-color:#f9f2f4;border-radius:4px}pre{display:block;padding:9.5px;margin:0 0 10px;font-size:13px;line-height:1.42857;word-break:break-all;word-wrap:break-word;color:#333;background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px}pre code{padding:0;font-size:inherit;color:inherit;white-space:pre-wrap;background-color:transparent;border-radius:0}*{box-sizing:border-box}*:before,*:after{box-sizing:border-box}html{font-size:10px;-webkit-tap-highlight-color:transparent}body{font-family:Verdana,Geneva,sans-serif;font-size:14px;line-height:1.42857;color:#333;background-color:#fff}a{color:#017890;text-decoration:none}a:hover,a:focus{color:#003944;text-decoration:underline}a:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}img{vertical-align:middle;max-width:100%}hr{margin-top:20px;margin-bottom:20px;border:0;border-top:1px solid #eee}html,body{height:100%;margin:0}code,pre{font-family:Menlo,Monaco,Consolas,"Courier New",monospace}div.wrapper{min-height:100%;margin-bottom:-39px}main{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}main:before,main:after{content:" ";display:table}main:after{clear:both}@media (min-width: 768px){main{width:750px}}@media (min-width: 992px){main{width:970px}}@media (min-width: 1200px){main{width:1170px}}.main-nav{margin-bottom:20px;padding-right:15px;padding-left:15px;padding-right:15px;padding-left:15px}.main-nav ul{padding:0;list-style:none;margin:0}.main-nav ul li a{color:#017890;padding:10px 15px;border-radius:4px;display:block;text-decoration:none}.main-nav ul li a:hover,.main-nav ul li a:focus{text-decoration:none;background-color:#eee}.main-nav ul li.active a,.main-nav ul li.active a:hover,.main-nav ul li.active a:focus{color:#fff;background-color:#017890}@media (min-width: 768px){.main-nav{float:left;width:34%}}@media (min-width: 992px){.main-nav{float:left;width:25%}}@media (min-width: 768px){.main-nav{float:right}}@media (max-width: 767px){.main-nav ul>li>a{padding:5px 10px}}.main-content{padding-right:15px;padding-left:15px;padding-right:15px;padding-left:15px}@media (min-width: 768px){.main-content{float:left;width:66%}}@media (min-width: 992px){.main-content{float:left;width:75%}}.content-wrap{margin-left:-15px;margin-right:-15px}.content-wrap:before,.content-wrap:after{content:" ";display:table}.content-wrap:after{clear:both}.main-header{margin-bottom:10px}@media (min-width: 768px){.main-header{margin-bottom:30px}}.main-header,.main-footer{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px;background-color:#017890}.main-header:before,.main-header:after,.main-footer:before,.main-footer:after{content:" ";display:table}.main-header:after,.main-footer:after{clear:both}.main-footer,.push{width:100%;height:39px}.push{margin-top:30px}.main-header a,.main-footer a,.main-header a:focus,.main-footer a:focus{text-decoration:none;color:#fff}.main-footer .pull-left{color:#fff;margin-top:10px;display:none}@media (min-width: 768px){.main-footer .pull-left{display:inline}}header a:hover,footer a:hover{text-decoration:none;color:#f7feff}.welcome,.recent-posts{margin-left:-15px;margin-right:-15px}.welcome:before,.welcome:after,.recent-posts:before,.recent-posts:after{content:" ";display:table}.welcome:after,.recent-posts:after{clear:both}.recent-posts .posts{padding-right:15px;padding-left:15px}@media (min-width: 768px){.recent-posts .posts{float:left;width:100%}}.recent-posts,.home-nav{margin-top:30px}.home-nav,.explanation{padding-right:15px;padding-left:15px}@media (min-width: 768px){.home-nav,.explanation{float:left;width:50%}}.post-title{margin-top:0;margin-bottom:0;font-size:16px;color:inherit}.home-nav{margin-bottom:20px}.home-nav ul{padding:0;list-style:none;margin:0}.home-nav ul li a{color:#017890;padding:10px 15px;border-radius:4px;display:block;text-decoration:none}.home-nav ul li a:hover,.home-nav ul li a:focus{text-decoration:none;background-color:#eee}.home-nav ul li.active a,.home-nav ul li.active a:hover,.home-nav ul li.active a:focus{color:#fff;background-color:#017890}.nav-pills>li>a{color:#017890}p.date-line{font-size:.75em;color:gray}.resume-title{text-align:center}.resume-section{margin-left:-15px;margin-right:-15px}.resume-section:before,.resume-section:after{content:" ";display:table}.resume-section:after{clear:both}.resume-section .section-title{padding-right:15px;padding-left:15px}@media (min-width: 992px){.resume-section .section-title{float:left;width:17%}}.resume-section .section-body{padding-right:15px;padding-left:15px}@media (min-width: 992px){.resume-section .section-body{float:left;width:83%}}.pager{padding-left:0;margin:20px 0;list-style:none;text-align:center;overflow:auto}.pager li{display:inline}.pager li a{display:inline-block;padding:5px 14px;background-color:#fff;border:1px solid #ddd;border-radius:15px}.pager li a:hover,.pager li a:focus{text-decoration:none;background-color:#eee}.pager .next{float:right}.pager .previous{float:left}h1.blog-index{font-size:30px}h1.blog-index small{font-size:14px}.lead{margin:0 0 10px;font-size:16px;margin-bottom:20px;font-weight:300;line-height:1.4}@media (min-width: 768px){.lead{font-size:21px}}.hide{display:none}img{max-width:100%}
    </style>
    <script>
      if (document.location.hostname.match('peterdebelak.com')) {
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-64190606-1', 'auto');
        ga('send', 'pageview');
      }
    </script>
  </head>
  <body >
    <div class="wrapper">
      <header class="main-header">
        <h1><a id="home" href="/">Peter Debelak</a></h1>
      </header>

      <main>
        <div class="content-wrap">
  <nav class="main-nav" role="navigation">
    <ul>
      <li class=""><a id="about" href="/about/">About</a></li>
      <li class=""><a id="resume" href="/resume/">Resume</a></li>
      <li class="active"><a id="blog" href="/blog/posts">Blog</a></li>
      <li><a id="github" href="https://github.com/pdebelak">Peter on Github</a></li>
    </ul>
  </nav>

  <section class="main-content">
    
  <article class="post">
    <header>
      <h1 class="blog-index">New Heroku Pricing<br><small><a href="/blog/posts/new-heroku-pricing/#disqus_thread">comments</a></small></h1>
      <p class="date-line">Last updated 27 June 2015</p>
    </header>
    <p><a href="https://blog.heroku.com/archives/2015/5/7/new-dyno-types-public-beta">Heroku’s new pricing</a>
introduces much better pricing for anyone who has been paying for Heroku’s
services, but introduces a huge change for people wanting to host their apps
for free — required downtime. Now all free apps have to sleep for 6 hours in
every 24 hour period.</p>

<p>What they are actually doing is making their free tier better for people who
use it in the way that they want — to get an app up and running in a
production environment for testing. They now give you a free web and worker
dyno so you can set up <a href="http://sidekiq.org/">sidekiq</a> at no cost while you are developing the app.
Previously, if you wanted to use a second dyno at all you almost certainly
had to pay some money.</p>

<p>Once users like this are ready to go into prime time they can either go through the
hassle of switching to a different hosting service like Amazon, or they can
just pay Heroku some money every month for more dynos that are always live.
Clearly, this is what Heroku wants.</p>

<p>Unfortunately, I wasn’t using the free tier of Heroku to test out an app in
development. I just wanted a single web dyno that, if pinged once an hour, was
up all the time to host my personal website. I had no plans of ever giving
Heroku any money, so it really makes no sense to give me free hosting. My
best option with Heroku would be to pay $7 a month to get a site that is always
up, and that is more than I’m willing to spend at the moment.</p>

<p>So, Heroku did very well. They are now giving free hosting to the people using
the service in the way that they want and stopping giving free hosting to
people who, like me, have no intention of ever paying.</p>

<p>As a result, I’ve switched this site’s technology (again). Now I’m using <a href="http://jekyllrb.com/">jekyll</a>
and hosting for free on <a href="https://pages.github.com/">github</a>. Which is great!</p>

    <hr>
  </article>

  <article class="post">
    <header>
      <h1 class="blog-index">Name Thy Args - Named Arguments in Ruby<br><small><a href="/blog/posts/name-thy-args-named-arguments-in-ruby/#disqus_thread">comments</a></small></h1>
      <p class="date-line">Last updated 21 June 2015</p>
    </header>
    <p>Just like <a href="/blog/posts/tappety-tap-tap-tap-object-tap-in-ruby/">last time</a>,
where I wrote about the underused <code>Object#tap</code> method, I want to talk about
a relatively new and underutilized feature in Ruby. Today it is named arguments.</p>

<p>Starting in Ruby 2.0, you could give your arguments names like so:</p>

<pre><code>def method(argument: "default")
  argument.length
end
</code></pre>

<p>This was nice, but since you were forced to provide a default value it wasn’t
always super useful. Starting in Ruby 2.1, though, the requirement for a default
was dropped so now you can write:</p>

<pre><code>def method(argument:)
  argument.length
end
</code></pre>

<p>Why is this so great? It provides documentation when a method is called. Have
you ever run across a method call like <code>do_thing(user, false)</code> in
an existing codebase? Don’t you immediately have to look up the <code>do_thing</code>
method to figure out what that <code>false</code> means? What if, instead, you saw
<code>do_thing(user: user, async: false)</code>? Now you don’t need to lookup
the code for that method since it is clear what the <code>false</code> means.</p>

<p>Another benefit is that the order doesn’t matter. <code>do_thing(async: false, user: user)</code>
works just as well. Just last week I spent almost an hour figuring out why a
test wasn’t passing before I realized I had some positional arguments in the
wrong order. Named arguments avoid that.</p>

<p>The name of the arguments can also give reminders about what type the arguments
should be. If you are supposed to pass a user id to the method, <code>do_thing(user, false)</code>
is a much easier mistake to make than <code>do_thing(user_id: user, async: false)</code>.
It is immediately obvious that it should be <code>do_thing(user_id: user.id, async: false)</code>.</p>

<p>Finally, Ruby is much more helpful about what is wrong when you forget a named
argument than positional arguments. If you try <code>do_thing(user)</code> you
get an error like <code>ArgumentError: wrong number of arguments (1 for 2)</code>. Then
you have to look at the method definition to see what you forgot. With named
arguments if you try <code>do_thing(user: user)</code>, you get an error like
<code>ArgumentError: missing keyword: async</code>, which is much more informative.</p>

<p>The only downsides to named arguments are that they make your method calls a
little more verbose, and that it makes any gems or libraries you create not as
backwards compatible. I think the verbosity is worth it, though, and I think
once Rails 5 comes out and people have to switch to Ruby 2.2 to use it, backwards
compatibility won’t be such a big issue. In a private codebase, of course, you
don’t have to worry about compatibility with old Rubies, so there is no downside
there.</p>

<p>I encourage you to use named arguments as much as possible. I think you’ll see
the benefits right away!</p>

    <hr>
  </article>

  <article class="post">
    <header>
      <h1 class="blog-index">Tappety Tap Tap Tap Tap - Object#tap in Ruby<br><small><a href="/blog/posts/tappety-tap-tap-tap-object-tap-in-ruby/#disqus_thread">comments</a></small></h1>
      <p class="date-line">Last updated 18 June 2015</p>
    </header>
    <p>There are a number of features that were added to Ruby in versions 1.9 or later
that don’t seem to be in wide use for some reason. One that I have a fondness
for is the <code>tap</code> method.</p>

<p>The <code>tap</code> method was added to the <code>Object</code> class in Ruby 1.9. All it does is
yield <code>self</code> to a block and then return <code>self</code>.</p>

<p>Here’s a simple example:</p>

<pre><code>Object.new.tap do |object|
  puts object
end
# returns the object
</code></pre>

<p>Doesn’t that seem useful? Not really? Okay. Well, according to <a href="http://ruby-doc.org/core-1.9.3/Object.html#method-i-tap">the docs</a>
the method is meant to “tap into” a method chain, in the same way you’d tap
into a rich vein of silver. Let’s see if we can find the silver here.</p>

<p>Imagine you need to create an object, call one of its methods, and then return
it.</p>

<pre><code>Hat.new(type: :bowler).tap do |hat|
  hat.tip
end
</code></pre>

<p>We’re getting closer.</p>

<p>What if you need to construct a string in a complicated way?</p>

<pre><code>"".tap do |string|
  string &lt;&lt; "Hello " if hello
  string &lt;&lt; "Sir " if should_sir?
  string &lt;&lt; "I'm writing to you"
  string &lt;&lt; " about #{about}" if about
  string &lt;&lt; "."
end
</code></pre>

<p>That’s so much better than the <code>string = ""; string &lt;&lt; "X" if something</code> alternative
that ends with <code>string</code> at the end to make sure you return it. <code>tap</code> takes care
of that for you.</p>

<p>The biggest benefit I’ve found of using <code>tap</code> is that it makes it easy to create
a variable with limited scope. This can be very useful in Rails views, especially
if you use decorators to add view-related methods to an object.</p>

<p>Take this haml:</p>

<pre><code>- decorated_post = PostDecorator.new(@post)
%h1= decorated_post.decorated_title
%p= decorated_post.decorated_body
</code></pre>

<p>That’s all fine, but if you are in a situation where you want to use two different
decorators in the same view, you might have something like this:</p>

<pre><code>- readably_decorated_post = ReadablePostDecorator.new(@post)
%h1= readably_decorated_post.decorated_title
%p= readably_decorated_post.decorated_body

- sortably_decorated_post = SortablePostDecorator.new(@post)
= link_to sortably_decorated_post.next_post
</code></pre>

<p>It can be hard to keep track of where a variable might be used and how. Also,
those variable names are long to differentiate from themselves from each
other. Try this instead:</p>

<pre><code>- ReadablePostDecorator.new(@post).tap do |decorated_post|
  %h1= decorated_post.decorated_title
  %p= decorated_post.decorated_body

- SortablePostDecorator.new(@post).tap do |decorated_post|
  = link_to decorated_post.next_post
</code></pre>

<p>I find that more readable and you have a good idea of the start and end of the
scope of the variables.</p>

<p>I hope this encourages you to bring out <code>Object#tap</code> for a little spin the next
chance you get.</p>

    <hr>
  </article>

<nav>
  <ul class="pager">
    
      <li class="previous">
        <a id="previous" href="/blog/posts/index.html">&larr; Newer posts</a>
      </li>
    
    
      <li class="next">
        <a id="next" href="/blog/posts/page3/">Older posts &rarr;</a>
      </li>
    
  </ul>
</nav>

  </section>
</div>

      </main>
      <div class="push"></div>
    </div>
    <footer class="main-footer">
      <span class="pull-left">Press <code>?</code> for help</span>
      <h4 class="text-right">
        <a href="mailto:pdebelak@gmail.com">Contact Peter</a>
      </h4>
    </footer>
    <script src="/js/shortcuts.min.js"></script>
    <script type="text/javascript">
      var disqus_shortname = 'peterdebelak';
      (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
    </script>
  </body>
</html>
