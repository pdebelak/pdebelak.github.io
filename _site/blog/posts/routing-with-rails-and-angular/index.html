<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Routing with Rails and Angular | Peter Debelak</title>
    <meta name="description" content="A brief guide to routing with Rails and AngularJS">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
    <style>
      *{box-sizing:border-box}body,html{height:100%;margin:0}header{background-color:#017890;overflow:auto;padding-right:15px;padding-left:15px}.container{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media (min-width:750px){.container{width:750px}}@media (min-width:992px){.container{width:970px}}@media (min-width:1200px){.container{width:1170px}}header{margin-bottom:30px}header a{text-decoration:none;color:#fff}
    </style>
    <script>
      if (document.location.hostname.match('peterdebelak.com')) {
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-64190606-1', 'auto');
        ga('send', 'pageview');
      }
    </script>
  </head>
  <body >
    <div class="wrapper">
      <header class="container-fluid">
        <h1><a id="home" href="/">Peter Debelak</a></h1>
      </header>

      <div class="container" >
        <nav class="col-md-3 col-md-push-9 col-sm-4 col-sm-push-8 navbar navbar-default" role="navigation">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#sidebar">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <p class="navbar-text visible-xs-block">Menu </p>
  </div>
  <div class="collapse navbar-collapse" id="sidebar">
    <ul class="nav nav-pills nav-stacked">
      <li class=""><a id="about" href="/about/">About</a></li>
      <li class=""><a id="resume" href="/resume/">Resume</a></li>
      <li class="active"><a id="blog" href="/blog/posts">Blog</a></li>
      <li><a id="github" href="https://github.com/pdebelak">Peter on Github</a></li>
    </ul>
  </div>
</nav>

<div class="col-md-9 col-md-pull-3 col-sm-8 col-sm-pull-4" id="main-content">
  <h1>Routing with Rails and Angular</h1>
<p class="date-line">Last updated 11 October 2014</p>
<p>There are a lot of great blog posts about setting up an app with <a href="http://rubyonrails.org/">Rails</a> as the back-end and <a href="https://angularjs.org/">AngularJS</a> as the front-end. You can find some <a href="http://www.intridea.com/blog/2014/9/25/how-to-set-up-angular-with-rails">here</a>, <a href="http://angular-rails.com/bootstrap.html">here</a>, or <a href="https://www.honeybadger.io/blog/2013/12/11/beginners-guide-to-angular-js-rails">here</a>. When it comes to routing, though, the best approach is unclear.

<p>If you are using <a href="https://docs.angularjs.org/api/ngRoute">ngRoute</a> (and you really should be to allow deep linking on your Angular app) your server should be able to handle requests like <code>/blog/posts/1</code> and show the appropriate blog post. You can easily do this by just routing all requests to your main index page and let Angular handle the routing. But what urls should Angular use to fetch the post from the server? You could namespace all of the server responses like <code>/api/blog/posts/1</code> but that doesn't really make sense. What you really want is to respond to <code>.html</code> requests by displaying the single-page Angular html and to respond to <code>.json</code> requests with the appropriate resource as json.
<p class="lead">Rails makes this easy!</p>
<p>As anyone who has generated scaffolding with Rails know, it is easy to craft a different response whether it is <code>.html</code> or <code>.json</code>. Your controllers frequently look like:
<pre>
def show
  @post = Post.find(params[:id])
  respond_to do |format|
    format.html # render the html view
    format.json # render the json view
  end
end
</pre>
<p>So, if I have my home page at <code>static_pages#home</code> I might write:</p>
<pre>
respond_to do |format|
  format.html { render 'static_pages/home' }
  format.json # rendering the show.json.erb file
end
</pre>
<p>Now you don't have to try to redirect all requests in your <code>config/routes</code> file or do anything crazy to properly respond to deep links.</p>
<p>This works fine, but I don't usually feel it necessary to create the <code>.json.erb</code> file for simple models and it also gets quite repetitive to have the same <code>respond_to</code> block in every controller action that takes a get request. Instead, I find that declaring a custom method in your <code>ApplicationController</code> that handles it for you:</p>
<pre>
def ng_respond(response_for_json)
  respond_to do |format|
    format.html { render 'static_pages/home' }
    format.json { render json: response_for_json.to_json }
  end
end
</pre>
<p>That way you can create controller actions like this:</p>
<pre>
def show
  @post = Post.find(params[:id])
  ng_respond(@post)
end
</pre>
<p>I hope this helps you with routing in your Rails/Angular apps. Leave any tips you might have in the comments.
</p></p></p></p>


<nav>
  <ul class="pager">
    
    
      <li class="next">
        <a id="previous" href="/blog/posts/complex-activerecord-queries-with-includes/">Newer post &rarr;</a>
      </li>
    
  </ul>
</nav>

<div id="disqus_thread"></div>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
  var disqus_shortname = 'peterdebelak';
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

</div>

      </div>
      <div class="push"></div>
    </div>
    <footer class="container-fluid">
      <span class="pull-left">Press <code>?</code> for help</span>
      <h4 class="text-right">
        <a href="mailto:pdebelak@gmail.com">Contact Peter</a>
      </h4>
    </footer>
    <link rel="stylesheet" href="/css/main.css">
    <script src="/js/main.min.js"></script>
    <script type="text/javascript">
      var disqus_shortname = 'peterdebelak';
      (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
    </script>
  </body>
</html>
